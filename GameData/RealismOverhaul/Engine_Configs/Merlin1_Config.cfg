//	==================================================
//	Merlin 1
//
//	Manufacturer: SpaceX
//
//	=================================================================================
//	Merlin 1A
//	Falcon 1
//
//	Dry Mass: 760 Kg
//	Thrust (SL): 324.7 kN
//	Thrust (Vac): 369.2 kN
//	ISP: 253.7 SL / 288.5 Vac
//	Burn Time: 240
//	Chamber Pressure: 5.39 MPa
//	Propellant: LOX / RP-1
//	Prop Ratio: 2.17
//	Throttle: N/A
//	Nozzle Ratio: 14.5
//	Ignitions: 1
//	=================================================================================
//	Merlin 1B
//	Falcon 1+
//
//	Dry Mass: 760 Kg
//	Thrust (SL): 348.7 kN
//	Thrust (Vac): 394.6 kN
//	ISP: 264.5 SL / 299.2 Vac
//	Burn Time: 240
//	Chamber Pressure: 6.08 MPa
//	Propellant: LOX / RP-1
//	Prop Ratio: 2.17
//	Throttle: N/A
//	Nozzle Ratio: 16
//	Ignitions: 1
//	=================================================================================
//	Merlin 1BVac
//	
//
//	Dry Mass: ??? Kg
//	Thrust (SL): ??? kN
//	Thrust (Vac): 421.6 kN
//	ISP: ??? SL / 332.1 Vac
//	Burn Time: 240
//	Chamber Pressure: 6.08 MPa
//	Propellant: LOX / RP-1
//	Prop Ratio: 2.17
//	Throttle: N/A
//	Nozzle Ratio: 117
//	Ignitions: 1
//	=================================================================================
//	Merlin 1C
//	Falcon 9 Block I (v1.0)
//
//	Dry Mass: 630 Kg
//	Thrust (SL): 422.6 kN
//	Thrust (Vac): 482.63 kN
//	ISP: 267 SL / 304.8 Vac
//	Burn Time: 240
//	Chamber Pressure: 6.14 MPa
//	Propellant: LOX / RP-1
//	Prop Ratio: 2.17
//	Throttle: N/A
//	Nozzle Ratio: 16
//	Ignitions: 1
//	=================================================================================
//	Merlin 1CVac
//	Falcon 9 Block I (v1.0)
//
//	Dry Mass: 760 Kg
//	Thrust (SL): ??? kN
//	Thrust (Vac): 524.9 kN
//	ISP: ??? SL / 336 Vac
//	Burn Time: 400
//	Chamber Pressure: 6.14 MPa
//	Propellant: LOX / PR-1
//	Prop Ratio: 2.17
//	Throttle: 100% to 60%
//	Nozzle Ratio: 117
//	Ignitions: 4
//	=================================================================================
//	Merlin 1D
//	Falcon 9 v1.1
//
//	Dry Mass: 470 Kg
//	Thrust (SL): 654.3 kN
//	Thrust (Vac): 742.4 kN
//	ISP: 282 SL / 311 Vac
//	Burn Time: 240
//	Chamber Pressure: 9.72 MPa
//	Propellant: LOX / RP-1
//	Prop Ratio: 2.34
//	Throttle: 100% to 39%
//	Nozzle Ratio: 21.4
//	Ignitions: 4
//	=================================================================================
//	Merlin 1D+
//	Falcon 9 v1.2 (Full Thrust)
//
//	Dry Mass: 470 Kg
//	Thrust (SL): ??? kN
//	Thrust (Vac): 825 kN
//	ISP: 282 SL / 311 Vac
//	Burn Time: 240
//	Chamber Pressure: 10.8 MPa
//	Propellant: LOX / RP-1
//	Prop Ratio: 2.36
//	Throttle: 100% to 39%
//	Nozzle Ratio: 21.4
//	Ignitions: 4
//	=================================================================================
//	Merlin 1D++
//	Falcon 9 Block 5
//
//	Dry Mass: 470 Kg
//	Thrust (SL): ??? kN
//	Thrust (Vac): 914.22 kN
//	ISP: 282 SL / 311 Vac
//	Burn Time: 240
//	Chamber Pressure: 10.8 MPa
//	Propellant: LOX / RP-1
//	Prop Ratio: 2.36
//	Throttle: 100% to 39%
//	Nozzle Ratio: 21.4
//	Ignitions: 4
//	=================================================================================
//	Merlin 1DVac
//	Falcon 9 v1.1
//
//	Dry Mass: 490 Kg
//	Thrust (SL): ??? kN
//	Thrust (Vac): 805 kN
//	ISP: ??? SL / 345 Vac
//	Burn Time: 400
//	Chamber Pressure: 9.72 MPa
//	Propellant: LOX / RP-1
//	Prop Ratio: 2.36
//	Throttle: 100% to 39%
//	Nozzle Ratio: 117
//	Ignitions: 4
//	=================================================================================
//	Merlin 1DVac+
//	Falcon 9 v1.2 (Full Thrust, Block 5)
//
//	Dry Mass: 490 Kg
//	Thrust (SL): ??? kN
//	Thrust (Vac): 934.12 kN
//	ISP: ??? SL / 348 Vac
//	Burn Time: 400
//	Chamber Pressure: 10.8 MPa
//	Propellant: LOX / RP-1
//	Prop Ratio: 2.36
//	Throttle: 100% to 39%
//	Nozzle Ratio: 117
//	Ignitions: 4
//	=================================================================================

//	Sources:

//	[1] http://spaceflight101.com/spacerockets/falcon-9-v1-1-f9r/
//	[2] http://www.spacex.com/falcon9 (2015-09-21)
//	[3] http://www.spacex.com/falcon9 (2016-05-14)
//	[4] https://www.quora.com/Is-SpaceXs-Merlin-1Ds-thrust-to-weight-ratio-of-150+-believable
//	[5] https://twitter.com/elonmusk/status/728753234811060224 (min thrust of Merlin1D+ is ~40%)
//	[6] http://www.spacex.com/press/2012/12/19/spacex-falcon-9-upper-stage-engine-successfully-completes-full-mission-duration
//	[7] http://www.spacex.com/press/2012/12/19/spacex-completes-development-merlin-regeneratively-cooled-rocket-engine
//	[8] https://www.youtube.com/watch?v=rUDLxFUMC9c (eyeballed burn times)
//	[9] http://www.b14643.de/Spacerockets/Specials/U.S._Rocket_engines/engines.htm

//	Used by:

//	* LazTek
//	* RealFuels
//	* StarShine Industries
//	* SSTU

//	Notes:

//	* None of the Merlin 1 engines ever really failed, with the
//	  exception of the SpX-1/CRS-1 flight anomaly. The TF configs
//	  should not be considered complete by any means.
//	==================================================

@PART[*]:HAS[#engineType[Merlin1]]:FOR[RealismOverhaulEngines]
{
	%category = Engine
	%title = Merlin 1 Series
	%manufacturer = SpaceX
	%description = The whole family of Merlin 1 rocket engines, made by SpaceX.

	@MODULE[ModuleEngines*]
	{
		%EngineType = LiquidFuel
	}

	!MODULE[ModuleEngineConfigs],*{}
	!MODULE[ModuleAlternator],*{}
	!RESOURCE,*{}

	@MODULE[ModuleGimbal]
	{
		%gimbalRange = 5
		%useGimbalResponseSpeed = true
		%gimbalResponseSpeed = 8
	}

	MODULE
	{
		name = ModuleEngineConfigs
		type = ModuleEngines
		configuration = Merlin1A
		origMass = 0.76

		CONFIG
		{
			name = Merlin1A
			description = Used on Falcon 1 first stage
			minThrust = 369.2
			maxThrust = 369.2
			heatProduction = 58
			massMult = 1.0

			PROPELLANT
			{
				name = Kerosene
				ratio = 0.3907
				DrawGauge = True
			}

			PROPELLANT
			{
				name = LqdOxygen
				ratio = 0.6093
				DrawGauge = False
			}

			atmosphereCurve
			{
				key = 0 288.5
				key = 1 253.7
			}

			ullage = True
			pressureFed = False
			ignitions = 1

			IGNITOR_RESOURCE
			{
				name = ElectricCharge
				amount = 0.5
			}

			IGNITOR_RESOURCE
			{
				name = TEATEB
				amount = 4.0
			}
		}

		CONFIG
		{
			name = Merlin1B
			minThrust = 394.6
			maxThrust = 394.6
			heatProduction = 64
			massMult = 1.0			// From Wikipedia: turbopump weight was unchanged at 150 lbs.

			PROPELLANT
			{
				name = Kerosene
				ratio = 0.3907
				DrawGauge = True
			}

			PROPELLANT
			{
				name = LqdOxygen
				ratio = 0.6093
				DrawGauge = False
			}

			atmosphereCurve
			{
				key = 0 302.3
				key = 1 260.8
			}

			ullage = True
			pressureFed = False
			ignitions = 1

			IGNITOR_RESOURCE
			{
				name = ElectricCharge
				amount = 0.5
			}

			IGNITOR_RESOURCE
			{
				name = TEATEB
				amount = 4.0
			}
		}

		CONFIG
		{
			name = Merlin1BVac
			minThrust = 421.6
			maxThrust = 421.6
			heatProduction = 63
			massMult = 1.2			// No good source but it should be heavier than the SL version.

			PROPELLANT
			{
				name = Kerosene
				ratio = 0.3907
				DrawGauge = True
			}

			PROPELLANT
			{
				name = LqdOxygen
				ratio = 0.6093
				DrawGauge = False
			}

			atmosphereCurve
			{
				key = 0 332.1
				key = 1 195.5
			}

			ullage = True
			pressureFed = False
			ignitions = 1

			IGNITOR_RESOURCE
			{
				name = ElectricCharge
				amount = 0.5
			}

			IGNITOR_RESOURCE
			{
				name = TEATEB
				amount = 4.0
			}
		}

		CONFIG
		{
			name = Merlin1C
			description = Used on Falcon 9 Block 1 (v1.0)
			minThrust = 482.63
			maxThrust = 482.63
			heatProduction = 96
			massMult = 0.829

			PROPELLANT
			{
				name = Kerosene
				ratio = 0.3907
				DrawGauge = True
			}

			PROPELLANT
			{
				name = LqdOxygen
				ratio = 0.6093
				DrawGauge = False
			}

			atmosphereCurve
			{
				key = 0 304.8
				key = 1 267
			}

			ullage = True
			pressureFed = False
			ignitions = 1

			IGNITOR_RESOURCE
			{
				name = ElectricCharge
				amount = 0.5
			}

			IGNITOR_RESOURCE
			{
				name = TEATEB
				amount = 4.0
			}
		}

		CONFIG
		{
			name = Merlin1CVac
			description = Used on Falcon 9 Block 1 (v1.0)
			minThrust = 314.94
			maxThrust = 524.9		// [9]
			heatProduction = 76
			massMult = 1.0

			PROPELLANT
			{
				name = Kerosene
				ratio = 0.3907
				DrawGauge = True
			}

			PROPELLANT
			{
				name = LqdOxygen
				ratio = 0.6093
				DrawGauge = False
			}

			atmosphereCurve
			{
				key = 0 336			// [9]
				key = 1 173
			}

			ullage = True
			pressureFed = False
			ignitions = 4

			IGNITOR_RESOURCE
			{
				name = ElectricCharge
				amount = 0.500
			}

			IGNITOR_RESOURCE
			{
				name = TEATEB
				amount = 1.0
			}
		}

		CONFIG
		{
			name = Merlin1D
			description = Used on Falcon 9 v1.1
			minThrust = 290
			maxThrust = 742.4
			heatProduction = 196
			massMult = 0.6184

			PROPELLANT
			{
				name = Kerosene
				ratio = 0.3729
				DrawGauge = True
			}

			PROPELLANT
			{
				name = LqdOxygen
				ratio = 0.6271
				DrawGauge = False
			}

			atmosphereCurve
			{
				key = 0 311
				key = 1 282
			}

			ullage = True
			pressureFed = False
			ignitions = 4

			IGNITOR_RESOURCE
			{
				name = ElectricCharge
				amount = 0.5
			}

			IGNITOR_RESOURCE
			{
				name = TEATEB
				amount = 1.0
			}
		}

		CONFIG
		{
			name = Merlin1D+
			description = Used on Falcon 9 v1.2 (Full Thrust)
			minThrust = 330
			maxThrust = 825			//[2]
			heatProduction = 225
			massMult = 0.6184

			PROPELLANT
			{
				name = Kerosene
				ratio = 0.3729
				DrawGauge = True
			}

			PROPELLANT
			{
				name = LqdOxygen
				ratio = 0.6271
				DrawGauge = False
			}

			atmosphereCurve
			{
				key = 0 311			// FIXME: M1D+ Isp is not same as M1D, exact spec difficult to pin down.
				key = 1 282
			}

			ullage = True
			pressureFed = False
			ignitions = 4

			IGNITOR_RESOURCE
			{
				name = ElectricCharge
				amount = 0.5
			}

			IGNITOR_RESOURCE
			{
				name = TEATEB
				amount = 1.0
			}
		}

		CONFIG
		{
			name = Merlin1D++		// Uprated again, slated to fly in mid/late 2016.
			description = Used on Falcon 9 Block 5
			minThrust = 330			// [5]
			maxThrust = 914.12		// [3]
			heatProduction = 248
			massMult = 0.6184

			PROPELLANT
			{
				name = Kerosene
				ratio = 0.3729
				DrawGauge = True
			}

			PROPELLANT
			{
				name = LqdOxygen
				ratio = 0.6271
				DrawGauge = False
			}

			atmosphereCurve
			{
				key = 0 311			// FIXME: M1D+ Isp is not same as M1D, exact spec difficult to pin down.
				key = 1 288.5
			}

			ullage = True
			pressureFed = False
			ignitions = 4

			IGNITOR_RESOURCE
			{
				name = ElectricCharge
				amount = 0.5
			}

			IGNITOR_RESOURCE
			{
				name = TEATEB
				amount = 1.0
			}
		}

		CONFIG
		{
			name = Merlin1DVac
			description = Used on Falcon 9 v1.1
			minThrust = 360
			maxThrust = 805
			heatProduction = 233
			massMult = 0.6447

			PROPELLANT
			{
				name = Kerosene
				ratio = 0.3709
				DrawGauge = True
			}

			PROPELLANT
			{
				name = LqdOxygen
				ratio = 0.6291
			}

			atmosphereCurve
			{
				key = 0 345
				key = 1 200
			}

			ullage = True
			pressureFed = False
			ignitions = 4

			IGNITOR_RESOURCE
			{
				name = ElectricCharge
				amount = 0.5
			}

			IGNITOR_RESOURCE
			{
				name = TEATEB
				amount = 1.0
			}
		}

		CONFIG
		{
			name = Merlin1DVac+
			description = Used on Falcon 9 v1.2 (Full Thrust and Block 5)
			minThrust = 360
			maxThrust = 934.12		 // [2]
			heatProduction = 225
			massMult = 0.6447

			PROPELLANT
			{
				name = Kerosene
				ratio = 0.3709
				DrawGauge = True
			}

			PROPELLANT
			{
				name = LqdOxygen
				ratio = 0.6291
				DrawGauge = False
			}

			atmosphereCurve
			{
				key = 0 348
				key = 1 200
			}

			ullage = True
			pressureFed = False
			ignitions = 4

			IGNITOR_RESOURCE
			{
				name = ElectricCharge
				amount = 0.5
			}

			IGNITOR_RESOURCE
			{
				name = TEATEB
				amount = 1.0
			}
		}
	}

	RESOURCE
	{
		name = TEATEB
		amount = 4.0
		maxAmount = 4.0
	}
}

//	==================================================
//	TestFlight compatibility.
//	==================================================
//Falcon 1: 5 flights, 1 failure
//
@PART[*]:HAS[@MODULE[ModuleEngineConfigs]:HAS[@CONFIG[Merlin1A]],!MODULE[TestFlightInterop]]:BEFORE[zTestFlight]
{
	TESTFLIGHT
	{
		name = Merlin1A
		ratedBurnTime = 300
		ignitionReliabilityStart = 0.800000
		ignitionReliabilityEnd = 0.960000
		cycleReliabilityStart = 0.800000
		cycleReliabilityEnd = 0.960000
	}
}

//Never flown?
@PART[*]:HAS[@MODULE[ModuleEngineConfigs]:HAS[@CONFIG[Merlin1B]],!MODULE[TestFlightInterop]]:BEFORE[zTestFlight]
{
	TESTFLIGHT
	{
		name = Merlin1B
		ratedBurnTime = 300
		ignitionReliabilityStart = 0.98
		ignitionReliabilityEnd = 0.995
		cycleReliabilityStart = 0.98
		cycleReliabilityEnd = 0.995
		techTransfer = Merlin1A:50
	}
}

//Never flown?
@PART[*]:HAS[@MODULE[ModuleEngineConfigs]:HAS[@CONFIG[Merlin1BVac]],!MODULE[TestFlightInterop]]:BEFORE[zTestFlight]
{
	TESTFLIGHT
	{
		name = Merlin1BVac
		ratedBurnTime = 345
		ignitionReliabilityStart = 0.98
		ignitionReliabilityEnd = 0.995
		cycleReliabilityStart = 0.98
		cycleReliabilityEnd = 0.995
		techTransfer = Merlin1A,Merlin1B:50
	}
}

//Falcon-9 v1.0: 5 flights, 1 failure
//45 engines, 1 failed
@PART[*]:HAS[@MODULE[ModuleEngineConfigs]:HAS[@CONFIG[Merlin1C]],!MODULE[TestFlightInterop]]:BEFORE[zTestFlight]
{
	TESTFLIGHT
	{
		name = Merlin1C
		ratedBurnTime = 300
		ignitionReliabilityStart = 0.977778
		ignitionReliabilityEnd = 0.995556
		cycleReliabilityStart = 0.977778
		cycleReliabilityEnd = 0.995556
		techTransfer = Merlin1A,Merlin1B,Merlin1BVac:50
	}
}

//Falcon 9 v1.0: 5 flights, 0 failures
//5 engines, 0 failed
@PART[*]:HAS[@MODULE[ModuleEngineConfigs]:HAS[@CONFIG[Merlin1CVac]],!MODULE[TestFlightInterop]]:BEFORE[zTestFlight]
{
	TESTFLIGHT
	{
		name = Merlin1CVac
		ratedBurnTime = 345
		ignitionReliabilityStart = 0.833333
		ignitionReliabilityEnd = 0.966667
		cycleReliabilityStart = 0.833333
		cycleReliabilityEnd = 0.966667
		techTransfer = Merlin1A,Merlin1B,Merlin1BVac,Merlin1C:50
	}
}
//Falcon-9 v1.1: 7 flights, 1 failure
//Falcon-9 v1.1(ex): 8 flights, 0 failures
//135 engines, 1 failed.
//159 ignitions, 1 failed.
@PART[*]:HAS[@MODULE[ModuleEngineConfigs]:HAS[@CONFIG[Merlin1D]],!MODULE[TestFlightInterop]]:BEFORE[zTestFlight]
{
	TESTFLIGHT
	{
		name = Merlin1D
		ratedBurnTime = 350
		ignitionReliabilityStart = 0.993711
		ignitionReliabilityEnd = 0.998742
		cycleReliabilityStart = 0.992593
		cycleReliabilityEnd = 0.998519
		techTransfer = Merlin1A,Merlin1B,Merlin1BVac,Merlin1C,Merlin1CVac:50
	}
}

//Falcon-9 v1.2: 28 flights, 0 failures
//Falcon-9 v1.2(ex): 8 flights, 0 failures
//324 engines, 0 failed
//396 ignitions, 0 failed
@PART[*]:HAS[@MODULE[ModuleEngineConfigs]:HAS[@CONFIG[Merlin1D+]],!MODULE[TestFlightInterop]]:BEFORE[zTestFlight]
{
	TESTFLIGHT
	{
		name = Merlin1D+
		ratedBurnTime = 350
		ignitionReliabilityStart = 0.997481
		ignitionReliabilityEnd = 0.999496
		cycleReliabilityStart = 0.996923
		cycleReliabilityEnd = 0.999385
		techTransfer = Merlin1A,Merlin1B,Merlin1BVac,Merlin1C,Merlin1CVac,Merlin1D:50
	}
}

//Falcon-9FT: 28 flights, 1 failures
//Falcon-9FT(ex): 8 flights, 0 failures
//Falcon-9 Block 5: 28 flights, 0 failures
//Falcon-9 Block 5 (ex): 2 flights, 0 failures
//594 engines, 1 failed
//762 ignitions, 0 failed
@PART[*]:HAS[@MODULE[ModuleEngineConfigs]:HAS[@CONFIG[Merlin1D++]],!MODULE[TestFlightInterop]]:BEFORE[zTestFlight]
{
	TESTFLIGHT
	{
		name = Merlin1D++
		ratedBurnTime = 350
		ignitionReliabilityStart = 0.998689
		ignitionReliabilityEnd = 0.999738
		cycleReliabilityStart = 0.998316
		cycleReliabilityEnd = 0.999663
		techTransfer = Merlin1A,Merlin1B,Merlin1BVac,Merlin1C,Merlin1CVac,Merlin1D,Merlin1D+:50
	}
}

//Falcon-9 v1.1: 6 flights, 0 failures
//Falcon-9 v1.1(ex): 8 flights, 0 failures
//14 engines, 0 failed
//Assuming 2 ignitions per flight average
//28 ignitions, 0 failed
@PART[*]:HAS[@MODULE[ModuleEngineConfigs]:HAS[@CONFIG[Merlin1DVac]],!MODULE[TestFlightInterop]]:BEFORE[zTestFlight]
{
	TESTFLIGHT
	{
		name = Merlin1DVac
		ratedBurnTime = 375
		ignitionReliabilityStart = 0.965517
		ignitionReliabilityEnd = 0.993103
		cycleReliabilityStart = 0.933333
		cycleReliabilityEnd = 0.986667
		techTransfer = Merlin1A,Merlin1B,Merlin1BVac,Merlin1C,Merlin1CVac,Merlin1D,Merlin1D+,Merlin1D++:50
	}
}

//Falcon-9FT: 28 flights, 0 failures
//Falcon-9FT(ex): 8 flights, 0 failures
//Falcon-9 Block 5: 28 flights, 0 failures
//Falcon-9 Block 5 (ex): 2 flights, 0 failures
//66 engines flown, 0 failed
//Assuming 2 ignitions per flight average
//132 ignitions, 0 failed
@PART[*]:HAS[@MODULE[ModuleEngineConfigs]:HAS[@CONFIG[Merlin1DVac+]],!MODULE[TestFlightInterop]]:BEFORE[zTestFlight]
{
	TESTFLIGHT
	{
		name = Merlin1DVac+
		ratedBurnTime = 400
		ignitionReliabilityStart = 0.992481
		ignitionReliabilityEnd = 0.998496
		cycleReliabilityStart = 0.985075
		cycleReliabilityEnd = 0.997015
		techTransfer = Merlin1A,Merlin1B,Merlin1BVac,Merlin1C,Merlin1CVac,Merlin1D,Merlin1D+,Merlin1D++,Merlin1DVac:50
	}
}
