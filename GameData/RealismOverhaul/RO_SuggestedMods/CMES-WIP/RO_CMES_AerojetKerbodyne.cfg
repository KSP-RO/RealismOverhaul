//  ==================================================
//  Sources:

//  Delta IV Payload User's Guide:   http://www.ulalaunch.com/uploads/docs/Launch_Vehicles/Delta_IV_Users_Guide_June_2013.pdf
//  Bipropellant Data Sheets:        https://www.rocket.com/files/aerojet/documents/Capabilities/PDFs/Bipropellant%20Data%20Sheets.pdf
//  Evolution of MPCV SM Propulsion: http://ntrs.nasa.gov/archive/nasa/casi.ntrs.nasa.gov/20150000145.pdf
//  Aerojet General Space Engines:   http://www.alternatewars.com/BBOW/Space_Engines/Aerojet_Engines.htm

//  ==================================================
//  Removed extra parts.
//  ==================================================

!PART[BasketTrussCX2]:FOR[RealismOverhaul]{}

!PART[BasketTrussCX21y]:FOR[RealismOverhaul]{}

//  ==================================================
//  Delta Cryogenic Second Stage (DCSS) 4 - meter truss.

//  Dimensions: 4 m x 1.3 m
//  Inert Mass: 220 Kg
//  ==================================================

+PART[ICPSAdapterx]:FOR[RealismOverhaul]
{
    @name = ICPSAdapterx2
    %RSSROConfig = True

    @MODEL
    {
        @scale = 1.6, 1.0, 1.6
    }

    @scale = 1.0
    @rescaleFactor = 1.0

    @node_stack_bottom = 0.0, -0.615, 0.0, 0.0, -1.0, 0.0, 3
    @node_stack_top = 0.0, 0.615, 0.0, 0.0, 1.0, 0.0, 3

    @title = Delta IV DCSS Truss (4 Meters)
    @manufacturer = United Launch Alliance (ULA)
    @description = The structural support truss for the 4 meter Delta Cryogenic Second Stage (DCSS) liquid Hydrogen and liquid Oxygen propellant tanks.

    @mass = 0.22
    @crashTolerance = 14
    @breakingForce = 250
    @breakingTorque = 250
    @maxTemp = 773.15
    %skinMaxTemp = 873.15
    @fuelCrossFeed = True
    !stageOffset = NULL
    !childStageOffset = NULL
    %bulkheadProfiles = size3

    !MODULE[ModuleCommand],*{}

    !MODULE[ModuleSAS],*{}

    !MODULE[ModuleReactionWheel],*{}

    !MODULE[MechJebCore],*{}

    !RESOURCE,*{}
}

//  ==================================================
//  Delta Cryogenic Second Stage (DCSS) 5 - meter truss.

//  Dimensions: 5 m x 2.6 m
//  Inert Mass: 430 Kg
//  ==================================================

@PART[ICPSAdapterx]:FOR[RealismOverhaul]
{
    %RSSROConfig = True

    @MODEL
    {
        @scale = 2.04, 2.0, 2.04
    }

    @scale = 1.0
    @rescaleFactor = 1.0

    @node_stack_bottom = 0.0, -1.2, 0.0, 0.0, -1.0, 0.0, 4
    @node_stack_top = 0.0, 1.2, 0.0, 0.0, 1.0, 0.0, 4

    @title = Delta IV DCSS Truss (5 Meters)
    @manufacturer = United Launch Alliance (ULA)
    @description = The structural support truss for the 5 meter Delta Cryogenic Second Stage (DCSS) liquid Hydrogen and liquid Oxygen propellant tanks.

    @mass = 0.43
    @crashTolerance = 14
    @breakingForce = 250
    @breakingTorque = 250
    @maxTemp = 773.15
    %skinMaxTemp = 873.15
    @fuelCrossFeed = True
    !stageOffset = NULL
    !childStageOffset = NULL
    %bulkheadProfiles = size4

    !MODULE[ModuleCommand],*{}

    !MODULE[ModuleSAS],*{}

    !MODULE[ModuleReactionWheel],*{}

    !MODULE[MechJebCore],*{}

    !RESOURCE,*{}
}

//  ==================================================
//  Delta Cryogenic Second Stage (DCSS) engine truss.

//  Dimensions: 3.1 m x 0.8 m
//  Inert Mass: 100 Kg
//  ==================================================

@PART[BasketTrussCX]:FOR[RealismOverhaul]
{
    %RSSROConfig = True

    @MODEL
    {
        @scale = 2.03, 3.1, 2.03
    }

    @scale = 1.0
    @rescaleFactor = 1.0

    @node_stack_top = 0.0, 0.85, 0.0, 0.0, 1.0, 0.0, 3
    @node_stack_bottom = 0.0, -0.335, 0.0, 0.0, -1.0, 0.0, 3

    @title = Delta IV DCSS Engine Truss
    @manufacturer = United Launch Alliance (ULA)
    @description = The Delta Cryogenic Second Stage (DCSS) avionics and engine holder truss.

    @mass = 0.1
    @crashTolerance = 12
    @breakingForce = 250
    @breakingTorque = 250
    @maxTemp = 773.15
    %skinMaxTemp = 873.15
    %bulkheadProfiles = size3
}

//  ==================================================
//  Orion MPCV Service Module linear thruster (radial).

//  Dimensions: 0.4 m x 0.8 m
//  Inert Mass: 25 Kg
//  ==================================================

@PART[X2009RCSX]:FOR[RealismOverhaul]
{
    %RSSROConfig = True

    @MODEL
    {
        %scale = 1.785, 1.785, 1.785
    }

    @scale = 1.0
    @rescaleFactor = 1.0

    @node_attach = 0.0, 0.0, 0.0, 0.0, 0.0, 0.0

    @title = Orion MPCV RCS Thruster (Radial)
    @manufacturer = Aerojet Rocketdyne
    @description = Linear RCS thruster pod, each containing two R-1E thrusters. Originally developed for the Constellation CEV as auxiliary thrusters for orbital maneuvers and as a backup for the main engine.

    @mass = 0.025
    @crashTolerance = 10
    %breakingForce = 250
    %breakingTorque = 250
    @maxTemp = 773.15
    %skinMaxTemp = 773.15
    %bulkheadProfiles = srf

    @MODULE[ModuleRCS]
    {
        @thrusterPower = 0.22
        !resourceName = NULL

        PROPELLANT
        {
            name = MMH
            ratio = 0.499
        }

        PROPELLANT
        {
            name = MON3
            ratio = 0.501
        }

        @atmosphereCurve
        {
            @key,0 = 0 280
            @key,1 = 1 100
        }
    }

    !MODULE[TweakScale],*{}
}

//  ==================================================
//  Orion MPCV Service Module linear thruster (inline).

//  Dimensions: 0.1 m x 0.4 m
//  Inert Mass: 16 Kg
//  ==================================================

@PART[XESARCSX]:FOR[RealismOverhaul]
{
    %RSSROConfig = True

    @MODEL
    {
        %scale = 3.85, 2.825, 3.85
    }

    %scale = 1.0
    @rescaleFactor = 1.0

    @node_attach = 0.0, 0.0, 0.0, 0.0, -1.0, 0.0

    @title = Orion MPCV RCS Thruster (Inline)
    @manufacturer = Aerojet Rocketdyne
    @description = Linear RCS thruster pod, each containing two R-4D-11 thrusters. Originally designed by Marquardt for use on the Apollo Service Module, the Lunar Ascent and Descent modules and as a satellite apogee motor. Later variants were modified to support new propellant combinations and to increase the efficiency.

    @mass = 0.016
    @crashTolerance = 10
    @breakingForce = 250
    @breakingTorque = 250
    @maxTemp = 773.15
    %skinMaxTemp = 773.15
    %bulkheadProfiles = srf

    @MODULE[ModuleRCS]
    {
        @thrusterPower = 0.98
        !resourceName = NULL

        PROPELLANT
        {
            name = MMH
            ratio = 0.499
        }

        PROPELLANT
        {
            name = MON3
            ratio = 0.501
        }

        @atmosphereCurve
        {
            @key,0 = 0 315.5
            @key,1 = 1 100
        }
    }

    !MODULE[TweakScale],*{}
}

//  ==================================================
//  Aerojet Rocketdyne AJ10-190 engine.

//  Dimensions: 1.17 m x 1.96 m
//  Inert Mass: 118 Kg
//  ==================================================

@PART[CHAKAOME2]:FOR[RealismOverhaul]
{
    %RSSROConfig = True

    @MODEL
    {
        @scale = 2.275, 2.15, 2.275
    }

    @scale = 1.0
    @rescaleFactor = 1.0

    @node_stack_top = 0.0, -0.365, 0.0, 0.0, 1.0, 0.0, 1
    %node_stack_bottom = 0.0, -1.54, 0.0, 0.0, -1.0, 0.0, 1

    @category = Engine

    @mass = 0.118
    @crashTolerance = 10
    @breakingForce = 250
    @breakingTorque = 250
    @maxTemp = 1023.15
    %skinMaxTemp = 1773.15
    %fuelCrossFeed = True
    %bulkheadProfiles = size3

    %engineType = AJ10_190
    %engineTypeMult = 1
    %massOffset = 0
    %ignoreMass = False

    @MODULE[ModuleEngines*]
    {
        @name = ModuleEnginesRF
        @minThrust = 26.7
        @maxThrust = 26.7
        @heatProduction = 100
        %exhaustDamageMultiplier = 0.75

        @PROPELLANT[LiquidFuel]
        {
            @name = MMH
            @ratio = 0.499
        }

        @PROPELLANT[Oxidizer]
        {
            @name = MON3
            @ratio = 0.501
            @DrawGauge = False
        }

        @atmosphereCurve
        {
            @key,0 = 0 316
            @key,1 = 1 100
        }
    }

    !MODULE[TweakScale],*{}
}

//  ==================================================
//  Aerojet Rocketdyne AJ10-190 engine.

//  Engine configuration.
//  ==================================================

@PART[CHAKAOME2]:AFTER[RealismOverhaulEngines]
{
    //  AJ10-190 has 6 degrees of gimbal for pitch and 7 for yaw.

    @MODULE[ModuleGimbal]
    {
        !gimbalRange = NULL
        %gimbalRangeXP = 6
        %gimbalRangeXN = 6
        %gimbalRangeYP = 7
        %gimbalRangeYN = 7
    }
}

//  ==================================================
//  Orion MPCV Service Module RCS block.

//  Dimensions: 0.3 m x 0.3 m
//  Inert Mass: 28 Kg
//  ==================================================

@PART[XRCSX]:FOR[RealismOverhaul]
{
    %RSSROConfig = True

    @MODEL
    {
        %scale = 1.785, 1.785, 1.785
    }

    %scale = 1.0
    @rescaleFactor = 1.0

    @node_attach = 0.0, 0.0, 0.0, 0.0, 0.0, 0.0

    @title = Orion MPCV RCS Block
    @manufacturer = Airbus Defence & Space
    @description = Multi - port RCS block for the Orion MPCV Service Module. Each thruster is rated for up to 220 N of thrust (440 N combined for each direction).

    @mass = 0.028
    @crashTolerance = 10
    %breakingForce = 250
    %breakingTorque = 250
    @maxTemp = 773.15
    %skinMaxTemp = 773.15
    %bulkheadProfiles = srf

    @MODULE[ModuleRCS]
    {
        @thrusterPower = 0.44
        !resourceName = NULL

        PROPELLANT
        {
            name = MMH
            ratio = 0.469
        }

        PROPELLANT
        {
            name = MON3
            ratio = 0.531
        }

        @atmosphereCurve
        {
            @key,0 = 0 270
            @key,1 = 1 100
        }
    }

    !MODULE[TweakScale],*{}
}
